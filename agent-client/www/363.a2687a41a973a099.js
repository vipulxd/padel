"use strict";(self.webpackChunkagent_client=self.webpackChunkagent_client||[]).push([[363],{1363:(U,l,a)=>{a.r(l),a.d(l,{UsermapModule:()=>L});var u=a(9808),p=a(8323),t=a(5e3),d=a(5724),g=a(7053),s=a(505);function m(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"button",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().requestLocationUpdate()}),t._uU(2,"START"),t.qZA()()}}function _(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"button",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().requestStopLocationUpdates()}),t._uU(2," STOP "),t.qZA()()}}function h(i,o){if(1&i&&t._UZ(0,"agm-marker",6),2&i){const e=o.$implicit,n=t.oxw();t.Q6J("latitude",e.lat)("longitude",e.lng)("agmFitBounds",!0)("iconUrl",n.icon)}}function f(i,o){1&i&&t._UZ(0,"option",15)}function v(i,o){1&i&&(t.TgZ(0,"option",16),t._uU(1,"IN PROGRESS "),t.qZA())}function M(i,o){1&i&&(t.TgZ(0,"option",17),t._uU(1,"COMPLETED "),t.qZA())}function T(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"select",11),t.NdJ("change",function(c){t.CHM(e);const r=t.oxw().$implicit;return t.oxw().updateStatus(r.task_id,c,r.latitude,r.longitude)}),t.YNc(1,f,1,0,"option",12),t.YNc(2,v,2,0,"option",13),t.YNc(3,M,2,0,"option",14),t._uU(4," }} "),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf","PENDING"===e.status),t.xp6(1),t.Q6J("ngIf","PENDING"==e.status||"COMPLETED"!=e.status),t.xp6(1),t.Q6J("ngIf","PENDING"!=e.status||"IN PROGRESS"==e.status)}}function C(i,o){1&i&&(t.TgZ(0,"div")(1,"b"),t._uU(2,"COMPLETED"),t.qZA()())}function S(i,o){if(1&i&&(t.TgZ(0,"agm-marker",6)(1,"agm-info-window",7)(2,"div"),t._uU(3),t.qZA(),t.TgZ(4,"div",8),t._uU(5),t.qZA(),t.TgZ(6,"div",9),t.YNc(7,T,5,3,"select",10),t.YNc(8,C,3,0,"div",2),t.qZA()()()),2&i){const e=o.$implicit,n=t.oxw();t.Q6J("latitude",e.latitude)("longitude",e.longitude)("agmFitBounds",!0)("iconUrl",n.pickupLocationsImage),t.xp6(1),t.Q6J("disableAutoPan",!1),t.xp6(2),t.hij(" ","Subject : "+e.task_subject," "),t.xp6(2),t.hij(" ","Message : "+e.task_message," "),t.xp6(2),t.Q6J("ngIf","COMPLETED"!=e.status),t.xp6(1),t.Q6J("ngIf","COMPLETED"===e.status)}}const x=[{path:"",component:(()=>{class i{constructor(e,n){this.locationService=e,this._authservice=n,this.coords=[{lat:0,lng:0,acc:0,createdAt:""}],this.updatingLocation=!1,this.icon={scaledSize:{width:45,height:45},url:"./../../assets/icons/locationMarker.svg"},this.pickupLocationsImage={scaledSize:{width:40,height:40},url:"./../../assets/icons/pickup.png"}}ngOnInit(){this._authservice.isAuthenticated.subscribe(e=>{this.isAuthenticated=e,e&&this.locationService.getCurrentLocation()}),this.locationService.coordinates.subscribe(e=>{0===this.coords[0].lat&&this.coords.pop(),this.coords.push(e)}),this.locationService.getCurrentLocation(),this.updatingLocation=this.locationService.isUpdatingLocation,this.locationService.fetchPickupLocations(),this.locationService.getPickupLocation().subscribe(e=>{this.pickupLocations=e},e=>{401==e.status&&(this._authservice.show.emit(!0),this._authservice.isAuthenticated.emit(!1))})}requestLocationUpdate(){this.updatingLocation=!0,this.locationService.startLocationTracking()}updateStatus(e,n,c,r){this.locationService.updateTaskStatus(e,n.target.value,c,r)}requestStopLocationUpdates(){this.updatingLocation=!1,this.locationService.stopLocationTracking()}getLocAcc(){return this.coords[this.coords.length-1].acc<10?20:this.coords[this.coords.length-1].acc<20?18:this.coords[this.coords.length-1].acc<30?16:15}ngOnDestroy(){this.locationService.stopFetchPick()}ngAfterViewInit(){this.locationService.getCurrentLocation()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.a),t.Y36(g.$))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-main"]],decls:8,vars:10,consts:[[1,"map-wrapper"],[1,"permission-btn-wrapper"],[4,"ngIf"],[3,"latitude","longitude","disableDefaultUI","zoom","usePanning","tilt"],[3,"latitude","longitude","agmFitBounds","iconUrl",4,"ngFor","ngForOf"],[1,"btn-home",3,"click"],[3,"latitude","longitude","agmFitBounds","iconUrl"],[3,"disableAutoPan"],[1,"message-body"],[1,"select-body"],["name","Status","id","status",3,"change",4,"ngIf"],["name","Status","id","status",3,"change"],["value","Task status",4,"ngIf"],["value","IN PROGRESS",4,"ngIf"],["value","COMPLETED",4,"ngIf"],["value","Task status"],["value","IN PROGRESS"],["value","COMPLETED"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,m,3,0,"div",2),t.YNc(3,_,3,0,"div",2),t.qZA(),t.TgZ(4,"agm-map",3),t._uU(5," > "),t.YNc(6,h,1,4,"agm-marker",4),t.YNc(7,S,9,9,"agm-marker",4),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngIf",!n.updatingLocation),t.xp6(1),t.Q6J("ngIf",n.updatingLocation),t.xp6(1),t.Q6J("latitude",n.coords[n.coords.length-1].lat)("longitude",n.coords[n.coords.length-1].lng)("disableDefaultUI",!0)("zoom",n.getLocAcc())("usePanning",!0)("tilt",100),t.xp6(2),t.Q6J("ngForOf",n.coords),t.xp6(1),t.Q6J("ngForOf",n.pickupLocations))},directives:[u.O5,s.SA,u.sg,s.pt,s.NC,s.d],styles:["agm-map[_ngcontent-%COMP%]{height:98vh;width:100vw}.permission-btn-wrapper[_ngcontent-%COMP%]{position:absolute;z-index:1!important;height:51px;width:100%;padding:20px;text-align:center}.message-body[_ngcontent-%COMP%]{width:180px}.select-body[_ngcontent-%COMP%]{padding:10px}"]}),i})()}];let k=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[p.Bz.forChild(x)],p.Bz]}),i})(),L=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[u.ez,k,s.su]]}),i})()}}]);
